<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="theme-color" content="#0f1115">
  <title>Storyboard</title>
  <link rel="stylesheet" href="styles.css" />
</head>
<body>
  <!-- ===== Top bar ===== -->
  <header class="topbar">
    <div style="display:flex; gap:8px; align-items:center">
      <button id="homeBtn" class="icon-btn" aria-label="Projects">üè†</button>
      <button id="menuBtn" class="icon-btn" aria-label="Menu">‚ò∞</button>
    </div>
    <div class="brand">
      <span class="logo">üé¨</span>
      <span class="title">Storyboard</span>
    </div>
    <div class="top-actions">
      <button id="presentBtn" class="seg">Present ‚ñ∂</button>
      <button id="viewToggle" class="seg" aria-haspopup="true">Comic ‚ñæ</button>
    </div>
  </header>

  <!-- ===== Actions sheet (menu) ===== -->
  <div id="sheet" class="sheet" aria-hidden="true">
    <div class="sheet-backdrop"></div>
    <div class="sheet-body" role="dialog" aria-label="Actions">
      <div class="sheet-grabber"></div>
      <h2>Actions</h2>

      <div class="sheet-grid">
        <button id="addSceneBtn" class="sheet-btn">‚ûï Add Scene</button>
        <button id="addShotsBtn" class="sheet-btn">üì• Add Shots</button>
        <button id="renderFilmBtn" class="sheet-btn">‚è∫ Render Film (MP4)</button>
        <button id="switchProjectBtn" class="sheet-btn">üè† Switch Project</button>
        <button id="exportBtn" class="sheet-btn">‚§µ Export JSON</button>
        <button id="importBtn" class="sheet-btn">‚§¥ Import JSON</button>
        <button id="clearBtn" class="sheet-btn danger">üóë Clear Project</button>
      </div>

      <label class="field">
        <span>Project name</span>
        <input id="projectName" type="text" placeholder="Untitled project" />
      </label>

      <button id="closeSheet" class="close-btn">Close</button>
    </div>
  </div>

  <!-- ===== Main content (Comic & Board views) ===== -->
  <main id="main">
    <!-- Comic View -->
    <section id="comicView" class="comic">
      <div class="comic-head">
        <p class="hint">Tap an empty box to add a shot. Tap a shot to edit. Long‚Äëpress a shot for replace/duplicate/delete.</p>
      </div>
      <div id="scenes" class="scenes"></div>
      <div class="spacer-80"></div>
    </section>

    <!-- Board View (vertical gallery) -->
    <section id="boardView" class="board hidden" aria-label="Board view">
      <div id="dropzone" class="dropzone" tabindex="0" role="button" aria-label="Add media">
        <div class="dz-inner">
          <strong>Drop images/videos</strong>
          <small>‚Ä¶or tap here to pick from camera roll</small>
        </div>
      </div>
      <div id="gallery" class="gallery"></div>
    </section>
  </main>

  <!-- ===== Shot Editor sheet ===== -->
  <div id="editor" class="sheet" aria-hidden="true">
    <div class="sheet-backdrop"></div>
    <div class="sheet-body" role="dialog" aria-label="Edit shot">
      <div class="sheet-grabber"></div>
      <h2 id="editorTitle">Edit Shot</h2>

      <div class="row cols-3">
        <label class="field"><span>Lens</span>
          <select id="edLens">
            <option>18mm</option><option>24mm</option><option>35mm</option>
            <option selected>50mm</option><option>85mm</option><option>100mm</option>
          </select>
        </label>
        <label class="field"><span>Shot Type</span>
          <select id="edShotType">
            <option>WS</option><option selected>MS</option><option>CU</option><option>ECU</option>
            <option>POV</option><option>OTS</option><option>2S</option><option>Establishing</option>
          </select>
        </label>
        <label class="field"><span>Transition (out)</span>
          <select id="edTransition">
            <option>Cut</option><option>Dissolve</option><option>Fade</option>
            <option>Wipe</option><option>Match Cut</option><option>Whip Pan</option>
            <option>J-Cut</option><option>L-Cut</option>
          </select>
        </label>
      </div>

      <div class="row">
        <div class="tags-label muted">Movements</div>
        <div id="edMoves" class="tags"></div>
      </div>

      <label class="field"><span>Dialogue / Subtitle</span>
        <textarea id="edDialogue" rows="2" placeholder="‚ÄúHe stares into the soup‚Ä¶‚Äù"></textarea>
      </label>
      <label class="field"><span>Description / Notes</span>
        <textarea id="edNotes" rows="2" placeholder="Lighting, blocking, extras‚Ä¶"></textarea>
      </label>

      <div class="audio-bar">
        <button id="recBtn" class="small-btn">üéô Record</button>
        <button id="playNoteBtn" class="small-btn" disabled>‚ñ∂ Play Note</button>
        <span id="recStatus" class="muted">No voice note</span>
      </div>

      <!-- New replace/delete controls inside editor -->
      <div class="audio-bar" style="justify-content:flex-start;gap:8px;margin-top:8px">
        <button id="edReplace" class="small-btn">‚Üª Replace media</button>
        <button id="edDelete" class="small-btn danger">üóë Delete shot</button>
      </div>

      <button id="closeEditor" class="close-btn">Done</button>
    </div>
  </div>

  <!-- ===== Transition picker ===== -->
  <div id="transPicker" class="sheet" aria-hidden="true">
    <div class="sheet-backdrop"></div>
    <div class="sheet-body" role="dialog" aria-label="Transition">
      <div class="sheet-grabber"></div>
      <h2>Choose Transition</h2>
      <div class="tags" id="transOptions"></div>
      <button id="closeTrans" class="close-btn">Close</button>
    </div>
  </div>

  <!-- ===== Presentation player ===== -->
  <div id="player" class="player" aria-hidden="true">
    <div class="player-chrome">
      <button id="closePlayer" class="icon-btn" title="Close">‚úï</button>
      <div class="controls-left">
        <button id="prevBtn" class="icon-btn" title="Prev">‚üµ</button>
        <button id="nextBtn" class="icon-btn" title="Next">‚ü∂</button>
      </div>
      <div class="controls-right">
        <button id="fsBtn" class="icon-btn" title="Fullscreen">‚õ∂</button>
      </div>
    </div>
    <div class="stage">
      <div class="stage-media"></div>
      <div class="overlay top-left" id="ovTopLeft"></div>
      <div class="overlay top-right" id="ovTopRight"></div>
      <div class="overlay bottom" id="ovBottom"></div>
    </div>
  </div>

  <!-- ===== Hidden file inputs ===== -->
  <input id="fileMulti" type="file" accept="image/*,video/*" multiple hidden />
  <input id="fileSingle" type="file" accept="image/*,video/*" hidden />
  <input id="importFile" type="file" accept="application/json" hidden />

  <!-- App JS -->
  <script src="app.js"></script>
</body>
</html>
